<!DOCTYPE html>
<html dir="ltr" lang="ja">
    <head>
        <title>クラスタ・分散・高信頼システム関連の世界観 - from Assy</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="keywords" content="Assy,アッシー,詩,小説,物語,歴史,政治,経済,コンピュータ,パソコン,Linux,エッセイ,散文,哲学">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="../../css/style.css">


<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
<link rel="manifest" href="/favicons/manifest.json">
<link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#5bbad5">
<meta name="theme-color" content="#ffffff">

    </head>
    <body>
<div class="page">
<script type="text/javascript" src="../../js/jquery.min.js"></script>
<script type="text/javascript" src="../../js/script_smartmenus.js"></script>
<script type="text/javascript" src="../../js/links2.js"></script>

<p><a href="index.html">ネットワークの世界観に戻る</a></p>
<div class="sidebar">
<iframe src="../../menus/network_menu.html" class="sideiframe"></iframe>
</div>
<h1>クラスタ・分散・高信頼システムの世界観</h1>
<p>クラスタ・分散・高信頼システムに関する世界観です。</p>

<div id="toc"></div>
<div class="page_links">

<h1>並列コンピューティング</h1>
<h2>並列コンピューティングを学びたい</h2>
<p>僕は、自分のプログラミング技術の勉強として、並列コンピューティングを学ぶことを目標にすることにした。</p>
<p>きっかけは、Webに対して限界を感じたことである。</p>
<p>Webは、CGIのように、ひとつひとつのページの中でプログラムが完結していて、別のファイルを読み込めるとは言っても、データの共有などは最小限であり、スタンドアローンのプログラムと比べると見劣りする。</p>
<p>僕の知識不足かもしれないが、Webでテキストエディタやワープロ・表計算ソフトなどを作るのは非常に難しいと思う。</p>
<p>よって、僕はPHPやRubyやJavaScriptといった言語は、最先端の流行プログラミング言語と言っても、本当のプログラミング技術ではないと思う。</p>
<p>本当のプログラミング技術とは、C/C++やJavaといった言語を用いた、スタンドアローンのプログラムだと思う。</p>
<p>そして、最近は並列処理言語が流行っている。Scala, Golang, Erlang, Rustといった最先端の言語は、並列処理に基づく設計の考え方をしている。また、LinuxやFreeBSDは古くから存在するOS技術でありながら、ほかのOSを並列処理を含めた高パフォーマンスで圧倒している。</p>
<p>これらの言語と技術は、スケーラビリティをその優越性としている。ひとつのマシンだけで高性能を発揮するのではなく、たくさんのマシンがクラスタのようにネットワークで結びついて、高パフォーマンスを叩き出すのである。</p>
<p>よって、並列コンピューティング技術は、決して昔のメインフレーム上のFORTRANやCOBOLやオープン系クラスタのような古い技術ではなく（これらの古い技術も今でも現役だが）、とても新しく最先端の技術なのである。</p>
<p>そして、僕は並列コンピューティング技術を研究した人に、プログラミングの高いスキルを持った人が多いと個人的に感じている。本や書籍の著者を見ても、並列コンピューティングを大学時代に学んだという人は僕の主観として多く感じる。並列コンピューティング技術は、プログラミング技術を学ぶ上で、スキルアップのために非常に有効なのである。</p>
<p>また、並列コンピューティング技術は、とても社会のためになる技術である。人工知能は監視に利用され、WebはSNS上のフェイクやいじめなどといった問題があり、ネットゲームは依存症の問題がある。これに比べて、並列コンピューティング技術は、特に医学上の薬やワクチンといった病気を治すための技術だったり、気象観測や気象災害の予測といった気象のための技術だったりと、とても社会にとって有益かつためになる技術だと思う。</p>
<p>僕は、並列コンピューティング技術とともに学ぶ言語として、Javaを選ぶ。Javaを選ぶ理由は、JavaにはJavaBeansやRMIといった、Java独自の分散コンピューティング技術が多いからだ。CORBAのような標準規格ではなくても、Javaはとても分散コンピューティングに適した言語である。同時に、Javaだけを学ぶのではなく、FORTRANやC/C++やPythonといった、科学技術計算やシステムに必要な言語は学ぶことが必要となる。あるいは、プログラミング技術だけではなく、数学、物理学、生物学、化学、地学、気象学、天文学といった、理系の学問はすべて、プロの学者並みに分かっている必要がある。そうでなければシミュレーションをするための計算プログラムが書けない。</p>
<p>そして、多くの並列コンピューティングに使うためのライブラリやフレームワークの知識も必要だし、アルゴリズムやデータ構造についても学ぶ必要がある。デザインパターンについては、通常のデザインパターンだけではなく、マルチスレッドに基づくデザインパターンもきちんと学ぶ必要がある。</p>
<p>そして何より、コンピュータ資源が必要だ。大学や研究機関のような、たくさんのコンピュータ資源が使える環境がなければ、並列コンピューティングを研究することはできない。だから、大学に入るために受験勉強から取り組まなければならない。そのためには高校の数学や理科の勉強が必須だ。もちろん、英語や国語や社会科についても勉強が必要となる。</p>
<p>よって、本当は、僕が実際に並列コンピューティングを学ぶことになるのは、まだまだはるかに先のことになる。それでも、「人生における目標が出来た」ということは評価すべきことだ。僕は今まで、何も知らないにもかかわらず色んなことを勉強した結果、これ以上常識を増やすことができなくなってしまった。そのため、これ以上僕は人生の残りの期間においてするべきことがなくなってしまった。すべきことがないなら何もしなければいいと思われるかもしれないが、何もしないで生きるというのは非常に辛い。だから、なんらかの目標が欲しかった。</p>
<p>だから、僕は今から、本を読んで並列コンピューティングとJavaの詳しい勉強をしていきたい。Linuxの知識はまったく無駄にはならない。そして、その勉強をした経験を活用して、さまざまなプログラミング技術を身に付けられればいいなと思っている。</p>
<p>後日注記：実際のところ、PHPでの各ページのデータ共有のためには、たとえばファイルにデータを記録したり、データベース管理システムを使えば、最低限なんとかはなります。ですが、それでも、C/C++やJavaのような、各機能でデータを共有できるプラットフォームほどに柔軟性はありません。また、僕は動的型付け言語が、大規模な開発には向いていないと思います。「あれ、このメンバ変数はどのクラスのメソッドを持っているのだったっけ？」となった時に、PHPなどでは簡単にクラスの型を知ることができません。なので、どれだけ動的型付けのWeb言語が流行しても、C/C++やJavaのよさというのはなくならないものだと思います。</p>
<p>後日注記：もしかしたら、PHPやRubyでも、各ページの中で同じオブジェクトを共有する方法があるかもしれません。たとえばRubyでは、RailsというWebフレームワークがありますが、もしかしてRailsを使えばそういうことができるかもしれません。そのような機能があったとしたら、それは僕の知識不足であり、不勉強のせいです。もしかしたらJavaのアプリケーションサーバやJavaBeansはそのようなものを実現しているのかもしれません。</p>
<p><a href="../prog_lang/java_servlet_javabeans.html">JavaBeans</a>も参照のこと。</p>

<h1>オープン系分散・クラスタシステム</h1>
<p>（<a href="https://www.amazon.co.jp/%E7%B5%B5%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8F%E3%81%8B%E3%82%8BIT%E3%82%A4%E3%83%B3%E3%83%95%E3%83%A9%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF-DB-SELECTION-%E5%B1%B1%E5%B4%8E-%E6%B3%B0%E5%8F%B2/dp/4798125733">絵で見てわかるITインフラの仕組み (DB SELECTION)</a>を参考に執筆しました。）</p>

<h2>メインフレームとオープン系システム</h2>
<p>エンタープライズシステムでは、大きく分けて、IBMのメインフレームのような「中央集約アーキテクチャ」と、UNIXやC/C++などの標準技術を用いた「オープン系分散・分割アーキテクチャ」に分かれる。</p>
<p>IBMのメインフレームは、巨大な大型コンピュータがひとつあり、内部の処理はとても高度かつ複雑で、とても大きな処理能力と信頼性があるが、ユーザーによる変更の柔軟性や拡張性が低く、コストも高くなる傾向にある。</p>
<p>これに対して、オープン系システムでは、ひとつひとつのコンピュータの処理能力はメインフレームほど大きくないが、たくさんのコンピュータをネットワークでつないで、分散型システムすなわち「クラスタ」を構築する。UNIXのような標準的OSやC/C++のような標準的言語を使うため、多くのコンピュータメーカー・ハードウェア・ソフトウェア・ベンダーに開かれているという意味で「オープン系」と呼ばれる。</p>
<p>一般的に、オープン系の方が拡張性や柔軟性が高いが、その代わりひとつひとつのコンピュータの性能や信頼性は低いため、ある特定の系が故障しても別の系が働くように「冗長化」や「アクティブ・スタンバイ」を行う必要がある。</p>
<p>（<a href="https://www.amazon.co.jp/%E7%B5%B5%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8F%E3%81%8B%E3%82%8BIT%E3%82%A4%E3%83%B3%E3%83%95%E3%83%A9%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF-DB-SELECTION-%E5%B1%B1%E5%B4%8E-%E6%B3%B0%E5%8F%B2/dp/4798125733">絵で見てわかるITインフラの仕組み (DB SELECTION)</a>を参考に執筆しました。）</p>
<p><a href="../hardware/mainframe.html">メインフレーム</a>も参照のこと。</p>

<h2>クラウドとオンプレ</h2>
<p>また、最近は企業の業務システムもクラウド化が進んでいる。</p>
<p>クラウドによって、ネットワーク上のシステムを社内でインターネットを通じて使うことで、自前でシステムを構築する場合よりもコストや手間の削減に繋がる。</p>
<p>これに対して、自社の企業内にシステムを配置し、自社運用するシステムを「オンプレ」と呼ぶ。</p>
<p><a href="cloud.html">クラウド</a>も参照のこと。</p>

<h2>三階層型システム</h2>
<p>現在の業務システムでは、三階層型システムと呼ばれる、Webブラウザをクライアントの操作端末とし、Webサーバ、APサーバ、DBサーバを用いてシステムを構築するのが一般的。</p>
<p>異なる種類のシステムであっても、多くの場合三階層型システムで対応できる。</p>
<p>（<a href="https://www.amazon.co.jp/%E7%B5%B5%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8F%E3%81%8B%E3%82%8BIT%E3%82%A4%E3%83%B3%E3%83%95%E3%83%A9%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF-DB-SELECTION-%E5%B1%B1%E5%B4%8E-%E6%B3%B0%E5%8F%B2/dp/4798125733">絵で見てわかるITインフラの仕組み (DB SELECTION)</a>を参考に執筆しました。）</p>

<h2>三階層型システムの応用</h2>
<p>商用のエンタープライズシステム、常に稼働していなければならないインフラなどではAPサーバにJava EEなどを使う。オープンソースかつ軽量なApache Tomcatのほか、多機能性を求める場合はオープンソースならRed HatのJBoss、あるいはOracleのWebLogicやIBMのJavaアプリケーションサーバなどを使うことがJavaのAPサーバとして一般的である。たくさんのマシンで分散環境を構築する場合、再利用可能なコンポーネントとしてJavaBeansやEJB、分散オブジェクト技術のRMIやCORBAを使うこともある。</p>
<p>WebのシステムならばAPサーバにRuby on RailsやNode.jsなどを使うことも多い。</p>
<p>DBサーバとしては、オープンソースで手軽なMySQLやPostgreSQLのほか、意外と今でもOracleなどのシェアが多い。Microsoft SQL Serverなども健闘している。IBM DB2はあまりシェアを大きく持っていないが無視できない存在である。</p>
<p>また、実運用ではそれぞれのサーバに異なる物理マシンを割り当てることが一般的だが、デプロイの前段階として開発用のマシンで動作試験を行う場合はDockerなどの仮想化システムを使い、運用マシンと同等の環境を試すことができる。</p>
<p><a href="../prog_lang/java_servlet.html">Javaサーブレット</a>や<a href="../db/rdbms.html">RDBMS</a>などを参照のこと。</p>

<h1>クラスタ・スパコンの考え方</h1>
<h2>ITインフラ用語</h2>
<p>自分の書いたブログ「神々とともに生きる詩人」<a href="../../diary/blog_frey/2021.02.02.html">2021/02/02</a>より。</p>
<table class="some_tables">
<tr><th class="min60">用語</th><th>説明</th></tr>
<tr><td>レプリケーション</td><td>レプリケーションは、データの複製を作ること。</td></tr>
<tr><td>ジャーナリング</td><td>ジャーナリングは、ログや記録を取ること。</td></tr>
<tr><td>ポーリング</td><td>ポーリングは、一定時間ごとに確認すること。</td></tr>
<tr><td>割り込み</td><td>割り込みは、処理の途中で別の処理が入ること。</td></tr>
<tr><td>ボトルネック</td><td>全体のスループットが悪い時、もっとも効率の悪い部分（ボトルの首）が、<br>全体の円滑な流れを全て制限してしまうことを、ボトルネックと呼ぶ。</td></tr>
<tr><td>冗長化</td><td>冗長化とは、ある部分が故障しても別の部分を使うことで、耐障害性をはかる仕組み。</td></tr>
<tr><td>フェイルオーバ</td><td>サーバがダウンしても別のサーバが代わりを務めることを、フェイルオーバと呼ぶ。</td></tr>
</table>
<p>（詳しくは<a href="https://www.amazon.co.jp/%E7%B5%B5%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8F%E3%81%8B%E3%82%8BIT%E3%82%A4%E3%83%B3%E3%83%95%E3%83%A9%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF-DB-SELECTION-%E5%B1%B1%E5%B4%8E-%E6%B3%B0%E5%8F%B2/dp/4798125733">絵で見てわかるITインフラの仕組み (DB SELECTION)</a>が参考になります。）</p>

<h2>冗長化とは</h2>
<p>データベースの勉強をしていると、「冗長構成の構築」という言葉が良く出てくる。</p>
<p>どんなに破損があっても別の同じシステムが代わりを務められるようにし、信頼性を確保する。</p>
<p>単にデータが破損した時のために別の場所に複製しておく（レプリケーション）ようなストレージ的な冗長性もあれば、あるシステムがダウンした時に別のシステムが代わりを務める（フェイルオーバ）ことで、ノンストップでシステムを安定稼働させるような、可用性を意味する冗長性もある。</p>
<p><a href="../db/db.html">データベース</a>も参照のこと。</p>

<h2>高性能と高可用性</h2>
<p>スパコンやクラスタでは、スピードや効率などのパフォーマンスを重視する「スケーラビリティ」と、ノンストップで安定してシステムが動き、データが失われず、どこかが故障されれば別のどこかが代わりを務めるような「リダンダンシー」（冗長性・高可用性）の種類がある。</p>
<p>ハイパフォーマンスクラスター（HPC）では、たくさんのコンピュータを繋げて並列処理を行うことで、極めて高速・高性能なクラスターを実現する。コンピュータをたくさん繋げることで高性能を目指すことをスケーラビリティと呼ぶ。</p>
<p>また、フェイルオーバは冗長性の一種で、システムが故障したりダウンしても、別のシステムが自動的に代わりを務めるようにする。</p>
<ul>
<li><a href="https://www.ibm.com/developerworks/jp/linux/library/l-cluster1/index.html">高性能Linuxクラスタリング、第1回：クラスタリングの基本 - IBM Developer</a>（<a href="https://web.archive.org/web/20190518162636/https://www.ibm.com/developerworks/jp/linux/library/l-cluster1/index.html">Webarchive</a>）</li>
</ul>

<h2>負荷分散とDNSラウンドロビン</h2>
<p>負荷分散の方法として、DNSラウンドロビンという方式があります。DNSサーバの名前解決技術を使うことで、クライアントからのリクエストを順番（ラウンドロビン）にそれぞれのサーバに分散します。</p>
<p>DNSラウンドロビンには、複雑な仕組みが必要なく、シンプルであるというメリットがありますが、負荷を効果的に割り振ることができず、サーバのダウンを検知できないというデメリットもあります。</p>
<p>このような場合には、より高度で柔軟な負荷分散技術であるロードバランサを用いることができます。</p>
<p>（<a href="https://www.amazon.co.jp/%E3%81%8A%E3%81%86%E3%81%A1%E3%81%A7%E5%AD%A6%E3%81%B9%E3%82%8B%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF%E3%81%AE%E3%81%8D%E3%81%BB%E3%82%93-Gene/dp/4798125261">おうちで学べるネットワークのきほん</a>を参考に執筆しました。）</p>
<div class="edit_date">
<p>2025.08.01</p>
</div>

<h2>負荷分散とロードバランサ</h2>
<p>ロードバランサは、サーバの負荷を分散させる仕組み。</p>
<p>ロードバランサは、クライアントとサーバの間に入り、中央で窓口となってリクエストを集中的に受け取り、それぞれのサーバに負荷のかかる処理を分散させる。クライアントから見ると、ロードバランサがサーバであるかのように見える。</p>
<p>Linux上でロードバランサクラスタを構築する技術にはLVS（Linux Virtual Server）、keepalived、ldirectord、HAProxyなどがある。</p>
<p>（詳しくは<a href="https://www.amazon.co.jp/dp/4295002666/">徹底攻略 応用情報技術者教科書 平成30年度</a>が参考になります。）</p>
<ul>
<li><a href="https://www.designet.co.jp/faq/term/?id=TFZT">LVSとは | OSSのデージーネット</a></li>
<li><a href="https://qiita.com/hana_shin/items/bda169d8d24f5954a992">keepalivedのインストール&amp;設定方法 - Qiita</a></li>
<li><a href="https://enterprisezine.jp/iti/detail/228">ldirectordで、LVS（Linux Virtual Server）による負荷分散システムの構築 (1/7)：EnterpriseZine（エンタープライズジン）</a></li>
<li><a href="https://knowledge.sakura.ad.jp/8078/">多機能なロードバランサとして使える多機能プロクシサーバー「HAProxy」入門 | さくらのナレッジ</a></li>
</ul>

<h2>マスター・スレーブ</h2>
<p>ロードバランサは、マスター・スレーブ（主人と奴隷）の一例。ひとりのロードバランサがネットワークシステム全体の「管理者」として働き、個々のサーバーはその「従事者」となる。ロードバランサ以外のマスター・スレーブの例としては、たとえば分散データベースのようなシステムは、ひとりの中央データベースが分散した個々のデータベースを統括する。あるいはワークロード管理なども、個々の仮想マシンのリソースを中央のジョブスケジューラが管理するという点でよく似ている。</p>
<ul>
<li><a href="https://www.amazon.co.jp/%E7%B5%B5%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8F%E3%81%8B%E3%82%8BIT%E3%82%A4%E3%83%B3%E3%83%95%E3%83%A9%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF-DB-SELECTION-%E5%B1%B1%E5%B4%8E-%E6%B3%B0%E5%8F%B2/dp/4798125733">絵で見てわかるITインフラの仕組み (DB SELECTION)</a></li>
</ul>
<div class="edit_date">
<p>2025.08.01</p>
</div>

<h2>ワークロード管理</h2>
<p>ワークロード管理について。基本的に、仮想サーバーのリソースを適切に配分する。空いているマシンのリソースを活用するためにリソースを再配分することは大切だが、もしリソースが外部から必要とされていて重要度が高かった場合には、再配分することに対するリスクもある。システムの日々の状態を分析して、適切に行うこと。</p>
<p>後日注記：ワークロード管理を行うためのソフトウェアをジョブスケジューラと呼ぶ。Linuxを用いたHPCクラスタ（高性能スパコン）のジョブスケジューラにはSlurmがよく使われている。</p>
<p>以下のページが参考になります。</p>
<ul>
<li><a href="http://yougo.ascii.jp/caltar/%E3%83%AF%E3%83%BC%E3%82%AF%E3%83%AD%E3%83%BC%E3%83%89%E7%AE%A1%E7%90%86">ワークロード管理 - 意味・説明・解説 : ASCII.jpデジタル用語辞典</a></li>
<li><a href="https://sc.ddbj.nig.ac.jp/guides/software/JobScheduler/Slurm/">Slurm の使い方 | NIG supercomputer</a></li>
</ul>
<p><a href="../virt/virt.html">仮想化</a>も参照のこと。</p>
<div class="edit_date">
<p>2024.03.05編集</p>
<p>2025.08.23編集</p>
</div>

<h2>スループットとレイテンシとボトルネック</h2>
<p>スループットとは、ある一定の時間において、どれだけの量処理を行うことができるかを示す、システムの性能を表す単位。</p>
<p>これに対してレイテンシあるいはレスポンスタイムは、ひとつの処理にかかる時間のことで、たとえばボタンをユーザーが押してどれくらいの時間で応答するか、といった所要時間のこと。</p>
<p>たとえば、一度に巨大サイズのデータを圧縮・解凍した上で送受信するようなシステムは、スループットはよくなるがレイテンシは悪くなる。スループットではなくレイテンシを上げるためには、たとえばマウスのクリックに対してOSやデバイスが反応する部分の速度を上げたり、小さなデータであれば非常に小さなサイズの箱に入れて瞬時に応答するようにすれば、レイテンシは速くなる。</p>
<p>後日注記：例として適切かは分からないが、たとえばWebブラウザとWebサーバーがやり取りする際に、リクエストに対するHTTPメッセージなどは、できるだけレスポンスタイムが短いほうがいい。そのため、このような場合はレイテンシ重視にして、できるだけ応答時間が短くなるように、最低限の情報だけをやり取りする。</p>
<p>感覚的には、スーパーのレジで待ち行列を待っている際に、ひとりひとりの能力は低くてもたくさんのレジ係を用意するのがスループット重視で、ひとりひとりのレジ係の能力を上げて一回の処理にかかる作業時間を減らすのがレイテンシ重視という感じかもしれない。</p>
<p>レイテンシが重要なのは、ユーザーとシステムが常にインタラクティブなやり取りをたくさん行うような、Webやゲームのようなシステム。最初から最後までまったくユーザーとのやり取りを行わないのであればスループット重視でもいいのかもしれない（スループットやレイテンシが問題になるのはさまざまな場合があるので、一概にそうとは言えない）。</p>
<p>レイテンシを重視するのであれば、データを最初に読み込んだ時にすべてメモリにキャッシュして、常にキャッシュとやり取りをし、いちいち行われるI/O処理をできるだけなくすなどの方法がある。Webブラウザなどはそうなっている。ただし、I/Oの変更処理を中心とするアプリケーションだった場合は、I/Oの変更処理が行われる度にキャッシュの更新処理が頻繁に必要になるので、逆に遅くなる。</p>
<p>また、I/Oのような時間がかかる処理はCPUの処理とは非同期で行い、非同期の処理が終わった地点で割り込みを行うなど、並列処理を上手く使うことで、CPUをできるだけ有効活用し、無駄な待ち時間をなくし、できるだけ合理的に効率化できる。そうすることで、スループットやレイテンシを向上させられる。カーネルはそのような仕事で効率化を行っている。</p>
<p>システムのスループットやレイテンシが遅い場合、ボトルネックと呼ばれる全体の流れを制限している部分を解消することで、システム全体の速度を向上させられる。すべてが均等な速度のシステムはあり得ないため、どのようなシステムであっても、ボトルネックは必ず存在する。特に、適切なサーバーとハードウェアの増強をした場合、最後にはデータベースがボトルネックとなる場合が多い。</p>
<ul>
<li><a href="https://www.amazon.co.jp/%E7%B5%B5%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8F%E3%81%8B%E3%82%8BIT%E3%82%A4%E3%83%B3%E3%83%95%E3%83%A9%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF-DB-SELECTION-%E5%B1%B1%E5%B4%8E-%E6%B3%B0%E5%8F%B2/dp/4798125733">絵で見てわかるITインフラの仕組み (DB SELECTION)</a></li>
<li><a href="https://qiita.com/kkino1985/items/de3e852d9bd8f4deb01c">[用語]スループットとレイテンシー #用語 - Qiita</a></li>
<li><a href="https://w.atwiki.jp/linux2ch/pages/47.html">NetworksFAQs - 5ch-Linux-Beginners - atwiki（アットウィキ）</a></li>
</ul>
<div class="edit_date">
<p>2025.08.01</p>
<p>2025.08.23編集</p>
</div>

<h2>アクティブ・スタンバイ構成</h2>
<p>データベースサーバーやファイルサーバーなど、データの一貫性が重要で、並列起動のできないシステムでは、クラスタソフトウェアを用いたアクティブ・スタンバイ構成で、フェイルオーバを実現する。</p>
<p>WebサーバーやAPサーバーは、データの一貫性が必要なく、サーバーを並列起動できるため、クラスタソフトウェアは必要ない。</p>
<p>アクティブ・スタンバイ構成では、生き残るノードを確認・決定するために、ハートビートと投票デバイスという仕組みを用いて、ノードの状況を確認している。このためにクラスタソフトウェアを用いる。</p>
<p>データの共有については、ひとつのディスクを複数のサーバーで共有するシェアードエブリシング型と、サーバーのノードごとにそれぞれのディスクを持つシェアードナッシング型がある。</p>
<p>（<a href="https://www.amazon.co.jp/%E7%B5%B5%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8F%E3%81%8B%E3%82%8BIT%E3%82%A4%E3%83%B3%E3%83%95%E3%83%A9%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF-DB-SELECTION-%E5%B1%B1%E5%B4%8E-%E6%B3%B0%E5%8F%B2/dp/4798125733">絵で見てわかるITインフラの仕組み (DB SELECTION)</a>を参考に執筆しました。）</p>
<div class="edit_date">
<p>2025.08.23</p>
</div>

<h2>書籍</h2>
<p>以下の書籍が参考になります。</p>
<ul>
<li><a href="https://www.amazon.co.jp/%E7%B5%B5%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8F%E3%81%8B%E3%82%8BIT%E3%82%A4%E3%83%B3%E3%83%95%E3%83%A9%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF-DB-SELECTION-%E5%B1%B1%E5%B4%8E-%E6%B3%B0%E5%8F%B2/dp/4798125733">絵で見てわかるITインフラの仕組み (DB SELECTION)</a></li>
<li><a href="https://www.amazon.co.jp/dp/4295002666/">徹底攻略 応用情報技術者教科書 平成30年度</a></li>
<li><a href="https://www.amazon.co.jp/%E3%81%8A%E3%81%86%E3%81%A1%E3%81%A7%E5%AD%A6%E3%81%B9%E3%82%8B%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF%E3%81%AE%E3%81%8D%E3%81%BB%E3%82%93-Gene/dp/4798125261">おうちで学べるネットワークのきほん</a></li>
</ul>

<h1>具体的なクラスタ技術</h1>
<h2>Linuxでクラスタをやってみよう</h2>
<p>クラスタとは、複数の分散コンピュータを使ってひとつのサーバやスパコンのようなシステムを構築する手法。</p>
<p>LinuxでHA（High Availability）クラスタを行うためには、以下のようなページが参考になる。</p>
<ul>
<li><a href="https://www.atmarkit.co.jp/ait/articles/0103/13/news002.html">多様化するクラスタ方式：Linuxクラスタリングへの招待（1） - ＠IT</a></li>
<li><a href="https://qiita.com/yubais/items/7c40227a17569dc9d412">Linux で計算機クラスタを作る (1. ネットワーク構築) - Qiita</a></li>
<li><a href="https://qiita.com/yubais/items/d05b789f3ae7fcc06084">Linux で計算機クラスタを作る (2. 分散ファイルシステム NFS 導入) - Qiita</a></li>
</ul>

<h2>Kubernetesでクラスタ</h2>
<p>僕が思うにKubernetesでクラスタをやるのが良いのではないかと。</p>
<ul>
<li><a href="https://qiita.com/Esfahan/items/4fcf51622fed20dffb88">Kubernetesハンズオン目次 - Qiita</a></li>
<li><a href="https://qiita.com/Esfahan/items/db7a79816731e6aa5cf5">Kubernetesでクラスタ環境構築手順(1) - masterの作成 - Qiita</a></li>
<li><a href="https://qiita.com/Esfahan/items/256fdb78e6a40b7c3e1f">Kubernetesでクラスタ環境構築手順(2) - nodeの作成 - Qiita</a></li>
</ul>
<p><a href="../virt/docker.html">Docker</a>や<a href="../virt/kubernetes.html">Kubernetes</a>も参照のこと。</p>

<h2>Beowulfでクラスタ</h2>
<p>Beowulfは結構昔に流行した分散システムで、OSにLinuxやBSDなどの安価なコモディティ製品を使う。並列処理ライブラリMPIなどとともに用いる。</p>
<ul>
<li><a href="https://www.atmarkit.co.jp/fcoding/articles/parallel/01/para01b.html">並列処理を体感してみよう （2/3）－ ＠IT</a></li>
<li><a href="https://linuxjf.osdn.jp/JFdocs/Beowulf-HOWTO.html">Beowulf HOWTO</a></li>
</ul>

<h2>Pacemaker</h2>
<p>Pacemaker（旧Heartbeatの後継）は比較的有名なOSSによる高可用クラスタシステム。</p>
<ul>
<li><a href="https://linux-ha.osdn.jp/wp/manual/pacemaker_outline">Pacemakerの概要 &laquo; Linux-HA Japan</a></li>
<li><a href="https://www.tohoho-web.com/ex/pacemaker.html">Pacemaker＋Corosyncメモ - とほほのWWW入門</a></li>
</ul>

<h2>LinuxのHPCクラスタの例</h2>
<p>LinuxのHPCクラスタには、Beowulf（NASA）、SCore（通商産業省）、MOSIX、Globusなどが挙げられる。</p>
<ul>
<li><a href="https://ja.wikipedia.org/wiki/Linux%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%BF%E3%83%BC">Linuxクラスター - Wikipedia</a></li>
</ul>
<p>クラスタ向けのパッケージには、openMosix、Kerrighed、OpenSSI、PVM、OSCAR、Grid Engineなどがある。</p>
<p>クラスタ用のディストリビューションには、Glusterがある。</p>
<ul>
<li><a href="https://www.itmedia.co.jp/enterprise/articles/0609/26/news036.html">オープンソースのクラスター管理システム (1/2) - ITmedia エンタープライズ</a></li>
<li><a href="http://misshie.jp/blog/2007/09/linux_hpc_1.html">みっし～の研究生活: Linux HPCクラスターの構築（その１）</a></li>
</ul>
<p>バッチシステム（JMS・ジョブスケジューラーと呼ばれる）には、OpenPBSやTorqueがある。</p>
<p>並列計算用のライブラリには、MPICHやMPICH2などがある。</p>
<ul>
<li><a href="http://www.kurobuti.com/linux_server/?page_id=58">並列計算クラスタサーバ構築 - 黒ぶちメガネのLinuxサーバ構築まとめ</a></li>
<li><a href="http://a98.jugem.jp/?eid=433">CentOS 6でバッチシステムといえばTORQUE(OpenPBS) | お試しlog4</a></li>
<li><a href="http://chem.tf.chiba-u.jp/gacb10/linux/cluster.html">並列計算機の製作 - 極限環境材料化学研究室 (千葉大学)</a></li>
</ul>

<h2>Linuxの高可用性クラスターの例</h2>
<p>Linuxでは高可用性クラスターの例として、Linux Virtual Server、Linux-HAによるHeartbeat/Pacemaker、Red HatによるRed Hat Cluster Suiteなどがある。</p>
<ul>
<li><a href="https://ja.wikipedia.org/wiki/%E3%82%B3%E3%83%B3%E3%83%94%E3%83%A5%E3%83%BC%E3%82%BF%E3%83%BB%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%BF%E3%83%BC">コンピュータ・クラスター - Wikipedia</a></li>
</ul>

<h2>Linux/OSSを使った高信頼システム</h2>
<!--
<p>Linux/OSSを使った高信頼システムを構築するためにどうすれば良いか。</p>
-->
<p>LinuCのサイトから無料で教科書がダウンロードできる。ただし個人情報の入力が必要。</p>
<ul>
<li><a href="https://linuc.org/textbooks/system/">高信頼システム構築標準教科書 －仮想化と高可用性－ ダウンロード LinuC-3 304試験対応 | Linux技術者認定試験 リナック | LPI-Japan</a></li>
</ul>

<h1>スパコン</h1>
<h2>スーパーコンピュータとLinux</h2>
<p>Linuxはスーパーコンピュータ用のOSとして良く使われている。以下のページを見れば分かる通り、TOP500のほとんどはLinux。IBMのスパコンではRHELが目立つが、ドイツのスパコンにはSUSEが良く使われているようだ。</p>
<ul>
<li><a href="https://ja.wikipedia.org/wiki/TOP500">TOP500 - Wikipedia</a></li>
</ul>

<h2>日本のスパコン</h2>
<p>日本のスパコンとしては京や地球シミュレータなどが過去に頑張っていた。地球シミュレータはNECによるスパコンで、かつてはベクトルプロセッサを用いた数少ないスパコンだった。</p>
<p>後日注記：2020年の富士通の京の後継「富岳」がTOP500で一位を取ったことで話題になりましたが、2022年にアメリカの「Frontier」に抜かれ、2024年ではアメリカの「El Capitan」が一位です。</p>
<ul>
<li><a href="https://ja.wikipedia.org/wiki/%E5%AF%8C%E5%B2%B3_(%E3%82%B9%E3%83%BC%E3%83%91%E3%83%BC%E3%82%B3%E3%83%B3%E3%83%94%E3%83%A5%E3%83%BC%E3%82%BF)">富岳 (スーパーコンピュータ) - Wikipedia</a></li>
<li><a href="https://ja.wikipedia.org/wiki/%E4%BA%AC_(%E3%82%B9%E3%83%BC%E3%83%91%E3%83%BC%E3%82%B3%E3%83%B3%E3%83%94%E3%83%A5%E3%83%BC%E3%82%BF)">京 (スーパーコンピュータ) - Wikipedia</a></li>
<li><a href="https://ja.wikipedia.org/wiki/%E5%9C%B0%E7%90%83%E3%82%B7%E3%83%9F%E3%83%A5%E3%83%AC%E3%83%BC%E3%82%BF">地球シミュレータ - Wikipedia</a></li>
<li><a href="https://ja.wikipedia.org/wiki/TOP500">TOP500 - Wikipedia</a></li>
</ul>
<div class="edit_date">
<p>2025.02.04編集</p>
</div>

<h1>クラスタ用ソフトウェア</h1>
<h2>Slurm</h2>
<p>Slurmはオープンソースなジョブスケジューラ（ワークロード管理ソフトウェア）。多くのスパコンやクラスタで使われている。</p>
<ul>
<li><a href="https://ja.wikipedia.org/wiki/Slurm_Workload_Manager">Slurm Workload Manager - Wikipedia</a></li>
</ul>

<h2>Beowulf</h2>
<p>LinuxやBSDによるオープンソースなクラスタ方式。</p>
<ul>
<li><a href="https://ja.wikipedia.org/wiki/Beowulf">Beowulf - Wikipedia</a></li>
</ul>

<h2>Linux Virtual Server</h2>
<p>Linuxによる負荷分散のための仮想サーバシステム。</p>
<ul>
<li><a href="https://ja.wikipedia.org/wiki/Linux_Virtual_Server">Linux Virtual Server - Wikipedia</a></li>
</ul>

<h2>Linux-HA/Heartbeat</h2>
<p>Linux-HAはLinuxなどによる高可用性システム。クラスタ管理プログラムHeartbeatを主な成果とする。</p>
<ul>
<li><a href="https://ja.wikipedia.org/wiki/Linux-HA">Linux-HA - Wikipedia</a></li>
</ul>

<h1>歴史上のOS</h1>
<h2>OpenVMS</h2>
<p>クラスタシステムは、歴史上のOSであるOpenVMSで最初に始められました。OpenVMSでは、可用性のひとつであるフェイルオーバの仕組みを特別な設定なしに実現します。</p>
<p><a href="../os/openvms.html">OpenVMS</a>も参照のこと。</p>
<div class="edit_date">
<p>2025.08.23</p>
</div>

<h1>関連ページ</h1>
<h2>分散ファイルシステム</h2>
<p><a href="dfs.html">分散ファイルシステム</a>を参照のこと。</p>

<h2>CORBA</h2>
<p><a href="corba.html">CORBA</a>を参照のこと。</p>

<h2>研究用の分散OS</h2>
<p><a href="../os/distributed_os.html">分散OS</a>を参照のこと。</p>

<h2>並列処理</h2>
<p><a href="../prog_lang/parallel.html">並列処理</a>を参照のこと。</p>

<h1>分散システムモデル</h1>
<h2>JavaScriptのような分散アプリケーションシステムを</h2>
<p>僕は、「分散環境」という時に、マシンをクラスタで用いることもできるとは思うが、そうではなく、たとえばjQueryのJavaScriptファイルをHTMLから呼び出すような形で、「分散アプリケーション環境」というのを作れないかと思う。</p>
<p>たとえば、「こんなソフトが使いたい」と思った時に、インターネットを検索して、そのURLからワンクリックでアプリケーションを起動できるようにする。</p>
<p>WebサービスやWebアプリケーションがこれに近いかもしれないが、専用のサービス運営サーバーを管理するのではなく、ただサーバーにアップしてある「バイナリファイル」を適切に実行できるようにする。</p>
<p>JavaScriptのようにすると面白いと思うのだが、実際はGNOMEのような「理想だけで終わってしまった」システムになるかもしれない。だが、ファイル共有ソフトがやっているように、P2Pで分散システムで「リレーション環境」ができれば、HTMLやハイパーテキストの考え方と結びついて、とても面白いことになるのではないかと思う。</p>

<h2>Webにおけるモジュールや連携</h2>
<p>面白いと思うのは、すでにあるサービスを組み合わせて、モジュールのように別のサービスを作ったり、連携させたりするような段階である。</p>
<p>ハイパーテキストのリンクからGoogle検索を作ることはできるが、たとえばInstagramとGoogleイメージ検索を組み合わせて、ハッシュタグのようなものから独自の検索をさまざまなオプションでできるようにするとか、そんな風に一種の仮想コンピュータシステムのようなものを、ネットのみんなで作ったり使ったりできるようにすると、面白いのかもしれないと思う。</p>
<p>インスタで流行している写真から、ストリートビューでその場所に行ってみよう的な、これはまだリンク利用の域を出ていないが、色んな応用が考えられる。ある意味、GNOMEやCORBAの理想はそういうものだったのかもしれない。</p>

<h2>ソーシャルハードウェア</h2>
<p>また、ハードウェアインフラ的なものを考えると、Cellチップがやっていたように、「みんなのパソコンを使って処理を分散して行う」というモデルも考えられる。</p>
<p>ゲームだけではなく、多くの処理をみんなのパソコンで行えば、「巨大なコンピュータ資源」が手に入り、カーナビやDVDレコーダーは資源の一つになって、世界中全ての機器が繋がる。</p>

<h2>たくさんのマシンが繋がったシステムでは、ワークロード管理が重要になる</h2>
<p>（以下の文章は、クラスタやワークロード管理について何も分かっていない、経験や知識のない自分の書いた文章であるため、一般的な良識と比較して間違ったことを教えています。注意してご覧ください。）</p>
<p>クラスタなど、たくさんのマシンが繋がったシステムでは、ワークロード管理が重要になります。</p>
<p>たとえば、MINIXで有名なアンドリュー・タネンバウム教授が作っている研究用の分散OS、Amoebaでは、ネットワークで繋がったたくさんのマシンを、ひとつのシステムであるかのように仮想化し、スケジューリングやメモリ管理を分散された中で行う、分散型のタイムシェアリングシステムを開発しています。</p>
<p>そのように、たくさんのマシンに繋がった環境では、たくさんのマシンがあるからこそ、そのマシンのリソースを適切に使わなければなりません。</p>
<p>仮想マシンのリソースをどのように配分するか、という「ワークロード管理」を行うためには、ジョブスケジューラと呼ばれるソフトウェアを使う必要があります。</p>
<p>ワークロード管理においては、余っているマシンにリソースを再配分することには、メリットとリスクが両方存在します。空いているマシンのリソースを有効に活用することもできますが、もしもサービスの重要度が高く、外部から必要とされていた場合、リソースを簡単に動かすのはリスクを伴います。</p>
<p>詳しくは以下のページが参考になります。</p>
<ul>
<li><a href="https://yougo.ascii.jp/caltar/%E3%83%AF%E3%83%BC%E3%82%AF%E3%83%AD%E3%83%BC%E3%83%89%E7%AE%A1%E7%90%86">ワークロード管理 - 意味・説明・解説 : ASCII.jpデジタル用語辞典</a></li>
</ul>
<div class="edit_date">
<p>2024.03.05編集</p>
</div>

<h1>簡単な説明</h1>
<h2>高信頼性システム</h2>
<ul class="defaultlist list7">
<li>データベース
<ul>
<li>高信頼性システム
<ul>
<li>冗長化・高可用性</li>
<li>HPC・スループット</li>
<li>クラスタ</li>
<li>分散システム</li>
</ul></li>
</ul></li>
</ul>

<h2>性能向上</h2>
<ul class="defaultlist list7">
<li>性能向上
<ul>
<li>ボトルネック
<ul>
<li>ネットワーク通信の性能は、瓶の首のように通信経路の中で一番狭くなっている部分に左右される</li>
</ul></li>
<li>スループット</li>
<li>レイテンシ</li>
</ul></li>
</ul>

</div></div> <!--page-->










<script type="text/javascript" src="../../js/jquery.toc.js"></script>
<script type="text/javascript" src="../../js/script.js"></script>
<script type="text/javascript" src="../../js/scriptfortoc.js"></script>
</body>
</html>