<!DOCTYPE html>
<html dir="ltr" lang="ja">
    <head>
        <title>C++関連の世界観A（戯言） - from Assy</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="keywords" content="Assy,アッシー,詩,小説,物語,歴史,政治,経済,コンピュータ,パソコン,Linux,エッセイ,散文,哲学">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="../../css/style.css">
        <link rel="stylesheet" href="../../css/prettify.css" type="text/css">


<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
<link rel="manifest" href="/favicons/manifest.json">
<link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#5bbad5">
<meta name="theme-color" content="#ffffff">

    </head>
    <body>
<div class="page">
<script type="text/javascript" src="../../js/jquery.min.js"></script>
<script type="text/javascript" src="../../js/script_smartmenus.js"></script>
<script type="text/javascript" src="../../js/links2.js"></script>

<p><a href="index.html">プログラミング言語の世界観に戻る</a></p>
<div class="sidebar">
<iframe src="../../menus/prog_lang_c_menu.html" class="sideiframe"></iframe>
</div>
<h1>C++の世界観A（戯言）</h1>
<p>C++によるプログラミングに関する世界観A（戯言）です。</p>

<h2>関連ページ</h2>
<ul class="defaultlist list6 menu_list">
<li><a href="cpp.html">C++（１．オブジェクト指向）</a></li>
<ul>
<li><a href="cpp_generics.html">２．ジェネリック</a></li>
<li><a href="cpp_stl_libs.html">３．STL・ライブラリ</a></li>
</ul>
<li><b>A．戯言</b></li>
</ul>
<p><a href="c.html">C</a>も参照のこと。</p>
<p>ツール関係は<a href="c_cpp_tools.html">C/C++ツール</a>に移動しました。</p>
<p>システムに依存する部分は<a href="../linux/linux_api.html">Linux（システムコール・API）</a>や<a href="windows_programming.html">Windowsプログラミング</a>も参照のこと。</p>
<p><a href="windows_mfc.html">Visual C++/MFC</a>も参照のこと。</p>

<div id="toc"></div>
<div class="page_links">

<h1>C++の特徴</h1>
<h2>もっとも難解かつ習得しづらいからこそ習得すべき</h2>
<p>C++は、他のどの言語よりも難解です。FORTRANよりも、Javaよりも、Perlよりも、Pythonよりも、Lispよりも難解であると言っていいでしょう。</p>
<p>しかしながら、もっとも難解かつ習得しづらいからこそ習得すべきです。</p>
<p>C++という言語が使えるということは、プログラマとして決定的な武器になります。</p>
<p>たとえば、Windowsやアプリケーションを使うだけの平均的なエンドユーザーは、プログラムを書くことはできません。これに対して、VBAやPythonのプログラマは、プログラムを書いて高度な処理を行うことができます。</p>
<p>しかしながら、PythonやRubyを使っていると、言語的な「用意されているもの」がとても多く、ほとんどは自分でロジックを書かなくても、モジュールやgemなどを用いて、いくらかスニペットを書くだけで、簡単にできてしまいます。もちろん、これがPythonやRubyの強みであり、言語的な水準が高く、少ない行でロジックが書けることは、プログラマにとっては強力で、また楽をすることができます。</p>
<p>しかしながら、WindowsやLinuxは、Pythonではコア部分を作ることができません。また、Pythonでは、インタープリタの上で動くスクリプトを書くことはできても、インタープリタやコンパイラのような「言語処理系そのもの」を作ることはできません。</p>
<p>C/C++は、そこが違います。WindowsやLinuxは、C/C++をもってすれば自分で開発することが（少なくとも組織の規模や手間の問題ではなく技術的な問題としては）可能です。また、言語処理系を作ることも、C++ならば可能です。</p>
<p>C/C++をもってすれば、カーネル、サーバーデーモン、言語処理系、ウィンドウシステム、ツールキット、Webブラウザ、Officeソフトウェアなど、「システムのすべてを開発できる」ということが言えます。</p>
<p>そう、Windowsを使っているだけのエンドユーザーがPythonでプログラムを書くことに目覚めるのと同じように、Pythonスクリプトを書いている普通のプログラマがC/C++で自分の言語処理系を書くことに目覚めることができるのです。</p>
<p>しかしながら、C/C++は難解な言語です。C言語そのものはシンプルですが、ポインタのように低水準過ぎる点があり、メモリ安全性もありません。C++は、Cに対してこれでもかというぐらい機能をつめこんだ、もっとも難解かつカオスな言語になっており、その習得は困難を極めます。これに拍車をかけているのが、特にGUIプログラムにおけるプラットフォーム依存性です。Windows APIで作るのと、X11で作るのでは、まったく違ったプログラムを書かなければいけないため、「単にC++を覚えただけでは何もできず、さらにたくさんの技術を学ばなければいけない」のです。</p>
<p>しかしながら、皆さんにはC++の習得をおすすめします。ある意味、僕自身が、C++だけがきちんと習得できていない、というのもここに書く理由のひとつです。C++を理解するためには、とても長い修行が必要です。WindowsユーザがPythonプログラマになるのは難しい道のりですが、PythonプログラマがC++プログラマになるのもそれと同じぐらい難しい道のりであると言えるでしょう。</p>

<h2>プログラマの登竜門</h2>
<p>C++言語を習得することは、一流のプログラマにとっては必ず必要です。C++はあらゆる場面で使われる、プログラミング言語の「王道」と言っても良いでしょう。あなたがプログラミングのことを「本当に習得したい」と思っているのであれば、C++を習得しましょう。</p>
<p>ただし、最近は必ずしもC++で書く場面は少なくなってきています。Java, VB, C#のような高水準のオブジェクト指向言語や、Python, PHP, Rubyのようなお手軽なスクリプト言語を使うことも多いです。C++を習得してからそれらに移行すれば、Webやサーバー、それからWindowsのようなプラットフォームにも十分に対応できます。</p>
<p>ですが、C++には挫折者がとても多いです。それは、「ポインタ、クラス、テンプレート、STL、わけのわからない難しいものが多すぎる」からです。難しいと思うなら、PerlやDelphiのような「コンピュータとしての方法や構造設計が分かりやすい言語」を試してみてください。それらを経験してからC++に戻ってくれば、きっと理解や習得が容易になるでしょう。</p>

<h2>C/C++はプログラミング界の帝王</h2>
<p>まさに、C/C++は、プログラミング界の帝王と言えます。それは、LinuxやWindowsの多くのコンポーネントは、C/C++で書かれており、多くのネイティブアプリケーションもC/C++で書かれているからです。</p>
<p>JavaやPythonのような他のプログラミング言語も、言語処理系そのものはC/C++で書かれています。</p>
<p>そう、C/C++で書かれている入手可能なソフトウェアリソースは、おそらく90%以上ではないかと思います。</p>
<p>よって、LinuxとC/C++を学びましょう。Linuxを使う理由は、gccやLLVM/ClangなどのC/C++コンパイラが無料かつオープンソースで手に入るからです。Linuxは多くのアプリケーションがオープンソースですが、この中でも、C/C++が使われているソフトウェアが多勢を占めています。</p>
<p>言ってしまえば、LinuxとC/C++以外、学ぶ必要はありません。</p>
<p>ただし、ひとつ注意しておくべきことは、「ポインタでメモリ管理をきちんとするのは難しい」ということです。このことだけに注意すれば、むしろ、JavaやPythonのような他の言語が「お遊び言語」に過ぎないことが良く分かるでしょう。</p>
<p>後日注記：基本的に、WindowsやLinuxのような「OSやネイティブアプリケーション」を書く場合はC/C++を使い、「大規模なプログラミングやシステム構築」を行う場合はJavaやその他の言語を使えば良いでしょう。</p>

<h2>ポインタとクラスの両立が難解でメモリ管理は手動</h2>
<p>C++に言えることとして、「ポインタとクラスの両立は難解」であるということが言えます。</p>
<p>C++では、ポインタを使いながらクラスベースのオブジェクト指向を行います。これにより、柔軟性が高く、どんな場合のコードにも対応できるという利点がありますが、難解で何をやりたいのかコードを見ただけでは全く分からないという欠点もあります。</p>
<p>Javaとは違い、メモリ管理を自分でしなければなりません。ですが、基本的に「プログラムの中で確保したものは、必ずプログラムの中で廃棄する」ということをきちんとやれば良いのです。これは難しいことではありません。</p>

<h2>システムプログラマの標準言語</h2>
<p>C++はシステムプログラマ向けの言語で、システムの中にすでに存在するアプリケーションを改造したい場合、ほとんどはC/C++で開発を行います。</p>
<p>Javaの方が使いやすいとは言われますが、Javaは専門の巨大システムを構築するために使うのであって、Webブラウザを改良したいなどの「システムプログラミング」における用途では、C++を使わざるを得ません。</p>
<p>こうした分野では速度と性能が重視されるため、Javaで作ることは現実的ではありません。</p>
<p>また、このような分野で必要なのは「きちんと動くアプリケーション」であり、C++を使って「正しく動くコモディティ的（個性のない汎用製品的）なコード」を書かなければなりません。</p>

<h1>C++とSmalltalk</h1>
<h2>レシーバ、メソッド、メッセージ</h2>
<p>C++はSmalltalkを参考にしたクラスベースのオブジェクト指向言語であり、Smalltalkの用語である「レシーバ」「メソッド」「メッセージ」は以下のような意味を持つ。</p>
<table class="some_tables">
<tr><th class="min60">用語</th><th>説明</th></tr>
<tr><td>レシーバ</td><td>レシーバは直訳すれば「受け手」であり、メッセージを受け取る側のオブジェクトを表す。</td></tr>
<tr><td>メソッド</td><td>メソッドは、レシーバに対して働きかけるメッセージとその時の処理のことで、C++では関数として実装する。</td></tr>
<tr><td>メッセージ</td><td>レシーバのメソッドを実行することを、「レシーバにメッセージを与える」と言う。<br>たとえば、オブジェクトobjに対してメソッドmeth()を実行することを、「objにmethメッセージを与える」と表現する。</td></tr>
</table>
<p>C++の「.」や「-&gt;」で言えば、.の左側にあるものをレシーバ、右側にあるものをメソッドとする。オブジェクト指向言語では、レシーバに対してメソッドを働きかけることで、あるデータに対する関数の「ふるまい」を記述して、プログラミングを行う。</p>
<p>C++でオブジェクト指向のクラスやメソッドを使うことを「なんとなく理解する」ためには、こうしたSmalltalkの基礎知識が有用である。メソッドを実行する、ということが何を意味しているのか、分かると理解しやすい。</p>

<h2>クラス階層</h2>
<p>SmalltalkやC++のようなオブジェクト指向言語では、オブジェクトを作成するために「クラス階層図」を利用する。</p>
<p>クラスとは、直訳すれば「階級」。</p>
<p>クラス階層図は、あらゆるデータ型は基本となるデータ型である「基本クラス」から派生したデータ型である「派生クラス」の、ひとつの抽象的な階層構造である「クラス階層」として表現される。全てのクラスは単一の「継承関係」にあり、基本のクラスを元にして派生クラスが作られる。</p>
<p>クラスには、オブジェクトの保持するデータの構造体メンバである「フィールド」あるいは「メンバ変数」と、そのメンバにはたらきかける付随の「メソッド」によって成り立つ。データ型とそれに付属するメソッドは、全体が継承関係にあり、基本のデータ型から派生したデータ型が作られ、クラス階層に記述されているメソッドからしか、データ型にはアクセスできない。</p>
<p>クラスベースのオブジェクト指向言語では、全てのオブジェクトの作成のために、こうした「クラス」を利用する。クラスはデータと関数をひとまとめにしたような構造体であると同時に、カプセル化や継承のような機能を提供する。自分でオリジナルのクラスを作るために、基本となるクラスを自分で継承することもできる。</p>
<p>クラスライブラリには以下のようなものがある。</p>
<table class="some_tables">
<tr><th class="min60">ライブラリ</th><th>説明</th></tr>
<tr><td><a href="windows_mfc.html">MFC</a></td><td>MicrosoftによるWindows向けのクラスライブラリ。<br>標準のC++では提供されないさまざまなクラスや、<br>Windowsコントロールの高度なAPIを提供する。<br>また、ドキュメント・ビュー・アーキテクチャにより、<br>C++でWindowsアプリケーションを実現するための、<br>ドキュメントとビューを中心とした高度なフレームワークを提供する。<br>言語はC++。</td></tr>
<tr><td><a href="java_lib.html">Java</a></td><td>Javaのパッケージは、Java SE, Java EE, Java EEにおいて<br>それぞれのクラスライブラリを提供する。<br>言語はJava。</td></tr>
<tr><td><a href="dotnet.html">.NET Framework</a></td><td>.NET FrameworkはMicrosoft版のJavaのようなもので、<br>Windowsアプリケーションの開発のためのクラスライブラリを提供する。<br>言語はC#/VB.NETなど。</td></tr>
<tr><td><a href="../os/nextstep.html">OPENSTEP</a></td><td>OPENSTEPはNeXTSTEP向けのオブジェクト指向開発環境。<br>macOSでCocoaとして採用されているほか、<br>フリー版実装のオープンソースなGNUstepなどがある。</td></tr>
<tr><td><a href="../linux/gtk.html">GLib/GObject/GTK+</a><br><a href="../linux/gnome.html">GNOME</a></td><td>GNOMEで採用されている、C言語によるオブジェクト指向を行うための機構。<br>GTK+のGUIウィジェットを使用できる。<br>言語はC/C++/Python/JavaScript/Valaなど多数のバインディングが開発されている。<br>オープンソース。</td></tr>
<tr><td><a href="../linux/qt.html">Qt</a><br><a href="../linux/kde.html">KDE Framework</a></td><td>KDEのC++のフレームワーク。<br>QtやKDEと美しく統合されたアプリケーションを開発できる。<br>言語はC++のほかPythonなど。<br>オープンソース。</td></tr>
</table>

<h2>オブジェクトに対する任意の演算子を定義する感覚に近い</h2>
<p>C++におけるオブジェクト指向は、オブジェクトに対する任意の演算子を定義する感覚に近いです。</p>
<p>たとえば、数値なら、1+1=2の「+」のようにしたいところを、さまざまなオブジェクトに対して、「.add()」や「.remove()」のような形で定義するのです。</p>
<p><a href="smalltalk.html">Smalltalk</a>では、こうしたメッセージ式を演算子と全く同じように定義して利用することができます。</p>

<h1>余談</h1>
<h2>C++には4つの領域がある</h2>
<p><a href="https://www.amazon.co.jp/Effective-%E7%AC%AC3%E7%89%88-ADDISON-WESLEY-PROFESSIONAL-COMPUTI/dp/4621066099">Effective C++ 第3版</a>の受け売りですが、C++には4つの領域があります。</p>
<p>まず一つ目は、C言語の領域。C++では、C言語のスーパーセットとして、「C言語で書くことのできるすべての言語仕様が引き継がれている」という特徴があります。</p>
<p>二つ目は、オブジェクト指向の領域。C++では、データ構造とメソッドを統合する「クラス」をベースとしたオブジェクト指向が可能となっています。また、名前空間により、グローバル変数などの識別子の衝突を回避できます。これらの特徴により、グローバル変数や構造体のポインタ、staticなどを使わなくても、大規模な開発が可能です。</p>
<p>三つ目は、ジェネリックの領域。C++ではテンプレートを使うことで、異なる型を汎用的に記述できます。</p>
<p>最後に、四つ目はSTLです。テンプレートを用いたライブラリであるSTLを使うことで、C言語にはないリストやベクターなどのデータ構造や、それに対する処理の機能を提供しています。</p>
<p>Effective C++で言われている通り、C++はこれらの「異なる言語の集合体」であると理解することができます。</p>
<p>また、僕が個人的に思うことを言えば、これらに対して「プラットフォーム別のクラスライブラリ」が追加で言えると思います。たとえば、特にGUIなら、WindowsならばWindows API（Win32 API）やMFC、UNIXならばQtやGTKです。</p>

<h2>基本的なコードが書けるようになったらEffective C++を読むこと</h2>
<p>以下のEffective C++は、C++の基本が分かった新米エンジニアが、「どのようなコードを書くべきか」ということを学ぶために有用です。</p>
<ul>
<li><a href="https://www.amazon.co.jp/Effective-%E7%AC%AC3%E7%89%88-ADDISON-WESLEY-PROFESSIONAL-COMPUTI/dp/4621066099">Effective C++ 第3版</a></li>
</ul>
<p>この本は、「C++のコードのデザイン原則」のような本で、可能な限りconstを使えとか、インターフェースは正しく使う時には使いやすく、間違った使い方では使いづらいようにしろとか、オブジェクトをコピーする時は全体をコピーしろとか、そうした「C++における細かな原則」が具体的で大まかに書かれた本です。</p>
<p>この本に目を通すことで、C++の基本的な「守るべき原則」が分かります。ですが、実際のC++のプログラミングができなければ分からないような内容も多く、初心者にはおすすめできません。初心者はもっと別のC++の入門本を買いましょう。</p>
<p>C/C++はさまざまな分野に用いられることが多く、柔軟な記述が可能であることを求められるため、実際のC++の現場についてどのようなコードを書いたらいいか検討がつかないような時に、この本にざっと目を通すと、「普通はこのように書くべきなのだ」ということが分かるでしょう。</p>
<p>Effective C++は時にとてもアルゴリズム的でコンピュータの内部に迫るようなことを言うために、数学のできない文系プログラマにとっては扱いづらい本かもしれませんが、きちんと同じことを考えると、「そうか、本当にこの方が効率が悪いのだな、そしてそれは私のせいなのだな」ということが分かって、とてもためになります。</p>
<p>後日注記：Effective C++はC++のカプセル化や効率などの面から見た「正しい選択」の分かる本だと思います。特に、コンストラクタが無駄に実行されるのを少なくするとか、カプセル化の面から見てクラスのメソッドでもfriendでもない関数を使うべきなのはなぜなのかなど、さまざまな「よく考えられた方法」を一気に習得できる本です。そのような観点から見ると、C++を使う上で参考にすべき設計の方法が見えてくると思います。</p>

<h2>リーナスはC++が大嫌い</h2>
<p>Linuxカーネルの開発者であるリーナス・トーバルズは、C++が大嫌いであることで知られます。</p>
<p>リーナスは、LinuxカーネルをC++で書くことをしません。LinuxカーネルはあくまでC言語（のGCC拡張）を使って記述します。</p>
<p>この理由は、カーネルの開発にC++が適していないだけではなく、リーナスがC++の言語仕様が大嫌いだからです。</p>
<p>僕はこのことを知って、C++を学ぶことをやめました。僕もリーナスと同じく、C++の言語仕様が好きではありません。C++の言語仕様は、特にC言語から引き継いだポインタの考え方や記法を、オブジェクト指向の動的なオブジェクトの作成のために転用している点など、多くがエレガントではないと思います。テンプレートやSTLの考え方も、僕は好きになれません。特にイテレータの記法などはまったく醜く、入出力ストリームの記法も醜いと思います。</p>
<p>なので、僕はこれ以上C++を学びません。僕はこれからはPythonやRubyやJavaScriptを学びたいと思います。</p>

<h2>ゼロ・オーバーヘッドの原則</h2>
<p>C++という言語では、新しい機能が追加される際に、「ゼロ・オーバーヘッドの原則」が守られる。</p>
<p>C++には、その機能を使わなかった場合に、プログラムのパフォーマンスを害することのないような機能しか追加されない。</p>
<p>なので、C++にたくさんの機能があるからといって、使いもしないのにその機能がプログラムのパフォーマンスを悪化させることはない。言語をCからC++にしたからといって、それだけでプログラムの速度悪化を気にせず、安心して使いたい機能だけを使うことができる。</p>
<p>ゼロ・オーバーヘッドの原則があるために、C++には不要になったメモリ領域を自動的に解放するガーベッジコレクション（GC）のような機能は実装されない。だが、最近のC++ではGCと同様の機能はスマートポインタが代わりに用意されている。</p>
<ul>
<li><a href="https://ja.wikipedia.org/wiki/C%2B%2B">C++ - Wikipedia</a></li>
<li><a href="https://ja.wikipedia.org/wiki/C%2B%2B11">C++11 - Wikipedia</a></li>
</ul>
<div class="edit_date">
<p>2023.05.10</p>
</div>

<h2>C/C++はメモリアドレスの言語</h2>
<p>C/C++では、ポインタの指し示す値を参照する*演算子や、ポインタの先にある構造体やオブジェクトを参照する-&gt;演算子をよく使います。</p>
<p>これを感覚的に理解するには、「メモリアドレスの先を指し示す」と考えることです。</p>
<p>そのメモリ上にあるデータの場所、インスタンスの存在する場所、その場所の先にあるデータを演算子やメソッドから参照するということを常に意識しましょう。</p>
<p>C/C++は、良くも悪くもメモリアドレスの言語です。malloc()やfree()のような関数、newやdeleteのような演算子を見ても、「C/C++はメモリアドレスの言語」だということがよく分かります。</p>
<p>メモリアドレスを直接操作できるため、C/C++はカーネルやコンパイラやシステムソフトウェアのような低水準レイヤーを書くのに向いています。</p>
<p>また、ゲームや画像ソフトのような、グラフィックス処理をする場合、C/C++で書くと高速に動くことが多いです。そのため、スピードと効率が必要なWebブラウザや2D/3DゲームにもC/C++がよく使われます。</p>
<div class="edit_date">
<p>2023.05.11</p>
</div>

<h2>巨大ソフトをゼロから作ることは困難なのでオープンソースの改良に取り掛かろう</h2>
<p>C/C++の開発をする上で、ひとりだけで巨大ソフトウェアを開発することは難しいです。</p>
<p>C/C++は、確かにカーネルやコンパイラ、あるいはシステムソフトウェアやWebブラウザなどを書くのに適した言語です。</p>
<p>ですが、このような巨大ソフトウェアは、高度かつ複雑であり、サイズも大きく、ひとりだけでゼロから作り出すのは困難を極めます。</p>
<p>なので、自分ひとりだけでC/C++の開発を行うのは、現実的ではありません。</p>
<p>会社で行うなら、会社の技術を学んで作ればいいことになりますが、何も技術力や経験がないのに会社に入ったところで、いきなり即戦力で開発をすることは難しいです。</p>
<p>幸いにも、わたしたちにはオープンソースソフトウェアがあります。カーネルを書きたいならLinuxや*BSD、コンパイラやインタープリタを書きたいならGCCやLLVMあるいはPerlのような言語処理系、Webブラウザを書きたいならMozilla Firefoxなど、オープンに開発されている「既存のソフトウェア」をベースに、自分の作りたい部分や機能だけを追加・変更することができます。</p>
<p>最初から、C/C++で高度なソフトウェアを全部作ることはできません。挫折どころか、スタートラインにすら立てずにやめていく人が多いです。なので、最初はオープンソフトウェアの改良から始めることをおすすめします。</p>
<p>C/C++ではありませんが、僕もオープンソースの２ちゃんねる専用ブラウザのOpenJaneをDelphiでビルドすることに成功し、改造して派生版を作ることでプログラミングの道を開きました。同じように、まず最初は既に存在するオープンソースソフトウェアのビルドができるようになることを目指しましょう。ビルドすらできてしまえば、コードを自由に書くことで自在にプログラムの開発ができます。まずは、オープンソースソフトウェアのビルドを行うことを最初の仕事にしてはいかがでしょうか。</p>
<div class="edit_date">
<p>2023.05.11</p>
</div>










</div></div> <!--page-->










<script type="text/javascript" src="../../js/jquery.toc.js"></script>
<script type="text/javascript" src="../../js/script.js"></script>
<script type="text/javascript" src="../../js/scriptfortoc.js"></script>
<script type="text/javascript" src="../../js/prettify.js"></script>
<script>prettyPrint();</script>
</body>
</html>