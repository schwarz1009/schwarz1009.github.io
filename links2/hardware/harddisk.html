<!DOCTYPE html>
<html dir="ltr" lang="ja">
    <head>
        <title>ハードディスクの世界観 - from Assy</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="keywords" content="Assy,アッシー,詩,小説,物語,歴史,政治,経済,コンピュータ,パソコン,Linux,エッセイ,散文,哲学">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="../../css/style.css">


<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
<link rel="manifest" href="/favicons/manifest.json">
<link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#5bbad5">
<meta name="theme-color" content="#ffffff">

    </head>
    <body>
<div class="page">
<script type="text/javascript" src="../../js/jquery.min.js"></script>
<script type="text/javascript" src="../../js/script_smartmenus.js"></script>
<script type="text/javascript" src="../../js/links2.js"></script>

<p><a href="index.html">ハードウェアの世界観に戻る</a></p>
<div class="sidebar">
<iframe src="../../menus/hardware_menu.html" class="sideiframe"></iframe>
</div>
<h1>ハードディスクの世界観</h1>
<p>ハードディスクの世界観です。</p>
<p>機械に詳しい父親の話を参考にしています。</p>

<div id="toc"></div>
<div class="page_links">

<h1>ハードディスク</h1>
<p>データの記憶装置。パソコンに内蔵されて用いられることが多い。</p>
<p><a href="../tech/magnetic_tape.html">磁気テープ</a>や<a href="../natural/physics_electromagnetism.html">電磁気学</a>も参照のこと。</p>

<h2>ハードディスクの仕組み</h2>
<p>昔のテープは、紙や磁気によるテープにデータを記録していたが、大容量の記録媒体になると、「どこにどんなデータがあるか」というのを、番地やアドレスで管理し、データが欲しい時はそのデータのある場所だけを読めば良いような仕組みが考えられた。</p>
<p>この番地を管理する特別な記憶領域を、ファイルアロケーションテーブル（FAT）と言う。フロッピーディスクやハードディスクでは、ファイルアロケーションテーブルからどこにデータがあるかを探し、データのアドレスに基づいてセクタ（個々の記憶領域）を読み出して、データを取得する。</p>
<p>磁気ディスク装置では、電磁気を用いた磁気ヘッドによるディスクの読み書きを行う。磁気ヘッドは電磁気によって磁気を感知する物質が塗られた磁気テープに情報を記録・読み取りする。これは、フロッピーディスクでも、ハードディスクでも変わらず、ハードディスクはより高精度に磁気記録を行うヘッドとディスクが構成されている。</p>
<p>フロッピーディスクとハードディスクの違いは、データを読み書きする速さである。フロッピーディスクの場合、テープにヘッドが着いている、つまり接触しているが、ハードディスクでは、ヘッドはディスクの上を「接触せずに」動いている。少しディスクから浮いた状態で動いているため、とても高速に動かすことができる。また、ハードディスクは高精度で、何千分の一ミリで動く。ディスク容量は、フロッピーディスクと比べても、1GB～2GBと当時からすると大容量だった。だが、衝撃に弱く、壊れやすいという欠点もある。</p>
<p>後日注記：最近機密情報の入ったハードディスクの不正転売問題がニュースになっているが、パソコンのOSがファイルを削除する際に、一般的に完全には削除しない。ファイルアロケーションテーブル内の「目次」を削除するだけで、実際のデータは後で別のデータに書き換えられるまで残っていることが多く、このような場合復元ソフトで目次だけを再構築すれば簡単に復元できてしまう。Linuxではshredコマンドなどで、完全に復元できないように削除することもできるが、物理的に破壊することが一番であり、今回の事件のように「物理的に破壊されるはずの超大容量のハードディスクが大量に売られていた」という話は、IT業界を揺るがす「とても恐ろしい話」である。</p>

<h2>セクタとトラック</h2>
<p>以下はハードディスク上のデータの場所を意味する用語集。</p>
<table class="some_tables">
<tr><th class="min60">用語</th><th>説明</th></tr>
<tr><td>セクタ</td><td>ハードディスクにおいてそれぞれのデータを記録するための、もっとも小さな単位。</td></tr>
<tr><td>トラック</td><td>セクタの同心円状の集合。トラックによって一面が形作られる。</td></tr>
<tr><td>シリンダ</td><td>中心から見て等距離に位置するトラックの集合。物理的には存在しない仮想的な概念。</td></tr>
</table>
<p>（「<a href="https://www.amazon.co.jp/%E4%BB%A4%E5%92%8C05%E5%B9%B4-%E3%82%A4%E3%83%A1%E3%83%BC%E3%82%B8%EF%BC%86%E3%82%AF%E3%83%AC%E3%83%90%E3%83%BC%E6%96%B9%E5%BC%8F%E3%81%A7%E3%82%88%E3%81%8F%E3%82%8F%E3%81%8B%E3%82%8B-%E6%A0%A2%E6%9C%A8%E5%85%88%E7%94%9F%E3%81%AE%E5%9F%BA%E6%9C%AC%E6%83%85%E5%A0%B1%E6%8A%80%E8%A1%93%E8%80%85%E6%95%99%E5%AE%A4-%E6%83%85%E5%A0%B1%E5%87%A6%E7%90%86%E6%8A%80%E8%A1%93%E8%80%85%E8%A9%A6%E9%A8%93-%E6%A0%A2%E6%9C%A8/dp/4297131307">平成18年度 イメージ&クレバー方式でよくわかる栢木先生の基本情報技術者教室 (情報処理技術者試験)</a>」を参考に執筆しました。）</p>

<h2>データの永続性</h2>
<p>メモリのデータには永続性がない。すなわち、電気を通さないと中のデータが消えてしまう。</p>
<p>ハードディスクは大容量であることと同時に、長期のデータの記憶や保管に向いている。</p>
<p>CPUはメモリとやり取りが多く高速である必要があるため、バスやI/OコントローラでCPUとメモリは近い位置に配置するが、ハードディスクは低速であり、やり取りも少ないため遠い位置に配置し、読み書きもキャッシュを用いることが多い。</p>
<p>（<a href="https://www.amazon.co.jp/%E7%B5%B5%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8F%E3%81%8B%E3%82%8BIT%E3%82%A4%E3%83%B3%E3%83%95%E3%83%A9%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF-DB-SELECTION-%E5%B1%B1%E5%B4%8E-%E6%B3%B0%E5%8F%B2/dp/4798125733">絵で見てわかるITインフラの仕組み (DB SELECTION)</a>を参考に執筆しました。）</p>

<h2>ライトスルーとライトバック</h2>
<p>メモリに限らずハードディスクにもライトスルーとライトバックがある。</p>
<p>ライトスルーでは、キャッシュに書き込まれたデータを、同時にハードディスクにも書き込む。コヒーレンシが保たれる（データの一貫性は保持される）が、スループレット（処理速度）は遅くなる。</p>
<p>ライトバックでは、キャッシュに書き込まれたデータを、すぐにはハードディスクには書き込まない。キャッシュに書き込まれた時点で別の処理を行う。後々になって、システムの負荷が少なくなった時などにハードディスクに書き込まれる。このため、コヒーレンシは必ずしも保たれないが、スループレットは速くなる。このため、カーネルの処理などが異常終了した場合、データが失われる可能性がある。</p>
<p>（<a href="https://www.amazon.co.jp/dp/4295002666/">徹底攻略 応用情報技術者教科書 平成30年度</a>を参考に執筆しました。）</p>

<h2>断片化とデフラグ</h2>
<p>断片化（フラグメンテーション）とは、ストレージのデータの使用領域や空き領域が非連続的になり、データがさまざまな場所に断片的に配置されること。</p>
<p>ストレージの中のデータは、必ずしも連続的に整った場所にあるとは限らない。</p>
<p>たとえば、10GBの空き容量があるとして、その空き領域が完全に連続してあるのではなく、ファイルの移動や削除を繰り返すことで、さまざまな場所にそれぞれ断片化されて空き領域が生まれることがある。</p>
<p>また、データがその領域にきっちりと収まっていたとしても、ファイルのサイズが拡大することで、別の離れた場所にデータが追記されることもある。</p>
<p>このような断片化は、ファイルの読み取り速度を低下させる原因になる。</p>
<p>ストレージの断片化を解消する方法として、「デフラグ」がある。デフラグを行うことで、ストレージのデータ領域が整理され、読み取り速度などを最適化することができる。</p>
<ul>
<li><a href="https://kotobank.jp/word/%E6%96%AD%E7%89%87%E5%8C%96-5700">断片化とは - コトバンク</a> - ASCII.jpデジタル用語辞典 「断片化」, IT用語がわかる辞典 「断片化」</li>
</ul>

<h2>SSD</h2>
<p>磁気ディスクのハードディスクは大容量だが、ヘッドの回転が必要という意味で、必ずしも高速ではない。</p>
<p>これに対して、SSDでは回転の必要が無いため、ハードディスクよりさらに高速であり、磁気ディスクのハードディスクはそのうちSSDに取って代われると言われている。</p>

<h1>余談</h1>
<h2>USBハードディスクはexFATでフォーマットしよう</h2>
<p>僕は、USBハードディスクに大事なデータをバックアップしていますが、ここでのファイルシステムフォーマットはexFATを使っています。</p>
<p>理由は、WindowsでもLinuxでも読み取れるようにするためです。</p>
<p>確かに、NTFSでフォーマットしたほうが、耐障害性などは優れているかもしれませんが、NTFSでフォーマットすると、Windowsからは読み取れても、Linuxから読み取れなくなってしまいます。</p>
<p>逆にext4でフォーマットすると、今度はLinuxからは読み取れても、Windowsから読み取れなくなってしまいます。</p>
<p>WindowsとLinuxの相互運用性を考えた上で、exFATでフォーマットするのがベターだと僕は思います。</p>
<p>後日注記：LinuxのfstabでexFATのファイルシステムをマウントする方法は以下のページが参考になります。</p>
<ul>
<li><a href="https://qiita.com/local0125/items/40f47550ea0f1e415275">exFATでフォーマットされた外部ストレージを任意のパーミッションでマウントする - Qiita</a></li>
</ul>
<p><a href="../linux/linux_unix_filesystem.html">UNIXシステム管理（ファイルシステム）</a>や<a href="../linux/linux_kernel_fs.html">Linuxカーネル（ファイルシステム）</a>も参照のこと。</p>

<h2>複数のハードディスクを切り替える装置</h2>
<p>昔、僕はWindowsの入ったハードディスクとLinuxの入ったハードディスクを両方使いながら切り替えるために、複数のハードディスクを切り替える装置を使っていました。</p>
<p>それによって、同じCPUやメモリを使いながら、Windowsのハードディスクから起動したり、Linuxのハードディスクから起動したり、ということができるようにしていました。</p>
<p>僕は当時中高生だったため、この仕組みは父親にやってもらったので、詳しい装置の名前などは知りませんが、デュアルブートと同じことができて、とても便利です。</p>
<p>それから、同じマウスやキーボードやモニターを使って、画面だけを切り替えるようなスイッチング機器も使っていました。WindowsとLinuxを同時に起動した上で、主にWindowsを使いながら、たまにLinuxに切り替えて、同じ画面と入力デバイスで複数のコンピュータを使うことができます。とても便利なので、皆さんにもおすすめします。</p>
<p>ただし、最近のWindowsやLinuxでは、このようなハードウェアによるスイッチング機器を使う必要はありません。なぜなら、仮想化ソフトを使えばいいからです。仮想化ソフトを使うことで、WindowsやMacの中でLinuxを動かすことは簡単にできます。ホストOSがLinuxの場合は、Dockerを使うことで、Linuxの上でいくらでも仮想マシンのコンテナを作り出すことができます。</p>
<p><a href="../virt/virt.html">仮想化</a>や<a href="../virt/docker.html">Docker</a>も参照のこと。</p>
<div class="edit_date">
<p>2024.10.28</p>
</div>

<!--
<h1></h1>
<h2></h2>
<ul>
<li><a href=""></a></li>
</ul>
-->





</div></div> <!--page-->










<script type="text/javascript" src="../../js/jquery.toc.js"></script>
<script type="text/javascript" src="../../js/script.js"></script>
<script type="text/javascript" src="../../js/scriptfortoc.js"></script>
</body>
</html>